# Задача по написанию тест-кейсов:

## УСПЕШНЫЕ СЦЕНАРИИ

### 001: Успешная оплата без 3-D Secure

**Предусловия:**
- Пользователь авторизован
- Заказ в статусе "Ожидает оплаты"
- Платежный шлюз доступен
- Используется валидная карта без 3DS

**Шаги:**
1. Ввести валидный номер карты
2. Ввести валидный срок действия
3. Ввести валидный CVV
4. Ввести имя владельца
5. Нажать «Оплатить»

**Ожидаемый результат:**
- Клиентская валидация успешна
- Запрос отправлен в шлюз
- Получен статус "Успешно"
- Статус заказа изменён на "Оплачен"
- Отображается сообщение об успешной оплате
- Отправлен чек на email

---

### 002: Успешная оплата с прохождением 3-D Secure

**Предусловия:**
- Пользователь авторизован
- Заказ ожидает оплаты
- Карта требует 3DS

**Шаги:**
1. Ввести валидные данные
2. Нажать «Оплатить»
3. Ввести корректный 3DS код
4. Подтвердить операцию

**Ожидаемый результат:**
- Происходит редирект на 3DS
- После подтверждения возврат в приложение
- Статус заказа = "Оплачен"
- Отображается успех
- Отправлен чек

---

## НЕГАТИВНЫЕ СЦЕНАРИИ

### 003: Оплата отклонена банком

**Предусловия:**
- Заказ ожидает оплаты
- Используется карта с ответом Declined

**Шаги:**
1. Ввести данные карты
2. Нажать «Оплатить»

**Ожидаемый результат:**
- Получен статус "Отклонено банком"
- Статус заказа не меняется
- Показано сообщение об отказе
- Чек не отправляется

---

### 004: Ошибка платежного сервиса

**Предусловия:**
- Шлюз возвращает 500 / timeout

**Шаги:**
1. Ввести валидные данные
2. Нажать «Оплатить»

**Ожидаемый результат:**
- Отображается сообщение об ошибке
- Статус заказа не меняется
- Чек не отправляется
- Ошибка логируется

---

### 005: Отмена оплаты на странице 3DS

**Предусловия:**
- Карта требует 3DS

**Шаги:**
1. Заполнить форму
2. Нажать оплатить
3. На 3DS нажать «Отмена»

**Ожидаемый результат:**
- Возврат в приложение
- Статус заказа = "Ожидает оплаты"
- Показано сообщение об отмене

---

## ВАЛИДАЦИЯ И ГРАНИЧНЫЕ ЗНАЧЕНИЯ

### 006: Пустые обязательные поля

**Предусловия:**
- Открыта форма оплаты

**Шаги:**
1. Оставить все поля пустыми
2. Нажать «Оплатить»

**Ожидаемый результат:**
- Показаны ошибки валидации
- Запрос в шлюз не отправляется

---

### 007: Невалидный номер карты (буквы)

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести буквы в номер карты
2. Нажать «Оплатить»

**Ожидаемый результат:**
- Ошибка валидации
- Запрос не отправляется

---

### 008: Неверная длина номера карты

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести 15 цифр
2. Ввести 17 цифр

**Ожидаемый результат:**
- Ошибка валидации

---

### 009: Просроченная карта

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести дату в прошлом

**Ожидаемый результат:**
- Ошибка «Срок действия истек»

---

### 010: Неверный CVV

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести 2 цифры
2. Ввести 4 цифры
3. Ввести буквы

**Ожидаемый результат:**
- Ошибка валидации

---

### 011: CVV = 3 цифры (валидная граница)

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести 3 цифры

**Ожидаемый результат:**
- Валидация успешна

---

### 012: Минимально допустимая длина карты

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести 16 цифр

**Ожидаемый результат:**
- Валидация проходит

---

### 013: Максимально допустимая длина карты

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести 19 цифр

**Ожидаемый результат:**
- Валидация проходит

---

## ИНТЕГРАЦИЯ

### 014: Проверка отправки запроса в шлюз

**Предусловия:**
- Есть доступ к DevTools

**Шаги:**
1. Выполнить оплату
2. Проверить Network

**Ожидаемый результат:**
- Запрос отправлен
- Передаются orderId, сумма, валюта
- PAN masked или токенизирован

---

### 015: Обновление статуса заказа

**Предусловия:**
- Оплата успешна

**Шаги:**
1. Проверить статус в UI
2. Проверить через API
3. Проверить в БД

**Ожидаемый результат:**
- Статус = "Оплачен"

---

### 016: Отправка email при успешной оплате

**Предусловия:**
- Оплата успешна

**Шаги:**
1. Проверить email

**Ожидаемый результат:**
- Получен чек
- Нет полного номера карты

---

### 017: Email не отправляется при ошибке

**Предусловия:**
- Оплата отклонена

**Шаги:**
1. Проверить email

**Ожидаемый результат:**
- Письмо отсутствует

---

## Стабильность 

### 018: Множественное нажатие кнопки оплаты

**Предусловия:**
- Форма заполнена

**Шаги:**
1. Быстро нажать кнопку несколько раз

**Ожидаемый результат:**
- Создан один платеж
- Нет двойного списания

---

### 019: Обновление страницы во время оплаты

**Предусловия:**
- Процесс оплаты начат

**Шаги:**
1. Нажать оплатить
2. Обновить страницу

**Ожидаемый результат:**
- Нет двойного платежа
- Статус корректный

---

## Безопасность

### 020: Маскирование номера карты

**Предусловия:**
- Оплата выполнена

**Шаги:**
1. Открыть страницу заказа

**Ожидаемый результат:**
- Отображается только **** **** **** 1234

---

### 021: CVV не хранится в системе

**Предусловия:**
- Оплата выполнена

**Шаги:**
1. Проверить БД
2. Проверить API

**Ожидаемый результат:**
- CVV отсутствует

---

### 022: Отсутствие хранения карты в localStorage

**Предусловия:**
- Оплата выполнена

**Шаги:**
1. Проверить localStorage/sessionStorage

**Ожидаемый результат:**
- Нет данных карты

---

### 023: Отсутствие чувствительных данных в логах

**Предусловия:**
- Есть доступ к логам

**Шаги:**
1. Выполнить оплату
2. Проверить frontend и backend логи

**Ожидаемый результат:**
- Нет PAN
- Нет CVV

---

### 024: Оплата чужого заказа (IDOR)

**Предусловия:**
- Есть 2 пользователя

**Шаги:**
1. Отправить запрос оплаты чужого orderId

**Ожидаемый результат:**
- 403 или 404
- Оплата невозможна

---

### 025: Доступ к оплате без авторизации

**Предусловия:**
- Пользователь не авторизован

**Шаги:**
1. Открыть URL оплаты

**Ожидаемый результат:**
- Редирект на логин

---

### 026: Replay attack

**Предусловия:**
- Платеж уже выполнен

**Шаги:**
1. Повторно отправить тот же request

**Ожидаемый результат:**
- Повторный платеж отклонён

---

### 027: HTTPS only

**Предусловия:**
- Открыта страница оплаты

**Шаги:**
1. Проверить протокол

**Ожидаемый результат:**
- Используется HTTPS

---

### 028: XSS в поле имени

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести script в поле имени

**Ожидаемый результат:**
- Скрипт не выполняется

---

### 029: SQL Injection

**Предусловия:**
- Форма оплаты открыта

**Шаги:**
1. Ввести `' OR 1=1 --`

**Ожидаемый результат:**
- Нет SQL ошибки
- Нет утечки данных

---

### 030: Email не содержит полный PAN

**Предусловия:**
- Оплата успешна

**Шаги:**
1. Проверить email

**Ожидаемый результат:**
- Номер карты masked

---

### 031: Изменение суммы через DevTools

**Предусловия:**
- Открыта форма оплаты

**Шаги:**
1. Изменить amount в request
2. Отправить запрос

**Ожидаемый результат:**
- Backend использует реальную сумму заказа
- Подмена невозможна

---

### 032: Истечение сессии оплаты

**Предусловия:**
- Открыта страница оплаты

**Шаги:**
1. Подождать истечения таймаута
2. Попробовать оплатить

**Ожидаемый результат:**
- Сообщение о завершении сессии

# Задача Playwright:
[ui](https://github.com/Checamaro/autotest-main-playwright)
